<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="description"
        content="Error Analyses of Auto-Regressive Video Diffusion Models: A Unified Framework">
  <meta name="keywords" content="AR, VDM">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Error Analyses of Auto-Regressive Video Diffusion Models: A Unified Framework</title>

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-PYVRSFMDRL"></script>
  <script>
    window.dataLayer = window.dataLayer || [];

    function gtag() {
      dataLayer.push(arguments);
    }

    gtag('js', new Date());

    gtag('config', 'G-PYVRSFMDRL');
  </script>

  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro"
        rel="stylesheet">

  <link rel="stylesheet" href="./static/css/bulma.min.css">
  <link rel="stylesheet" href="./static/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="./static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="./static/css/fontawesome.all.min.css">
  <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="./static/css/index.css">
  <link rel="icon" href="./static/images/favicon.svg">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script defer src="./static/js/fontawesome.all.min.js"></script>
  <script src="./static/js/bulma-carousel.min.js"></script>
  <script src="./static/js/bulma-slider.min.js"></script>
  <script src="./static/js/index.js"></script>
</head>
<body>


<section class="hero">
  <div class="hero-body">
    <div class="container is-max-desktop">
      <div class="columns is-centered">
        <div class="column has-text-centered">
          <h1 class="title is-1 publication-title">Error Analyses of Auto-Regressive Video Diffusion Models: A Unified Framework</h1>
          <div class="is-size-4 publication-authors">
            <span class="author-block">
              Wang Jing<sup>1,2</sup>*,</span>
            <span class="author-block">
              Fengzhuo Zhang<sup>3</sup>*,</span>
            <span class="author-block">
              Xiaoli Li<sup>2</sup>,
            </span>
            <span class="author-block">
              Vincent Y. F. Tan<sup>3</sup>,
            </span>
            <span class="author-block">
              Tianyu Pang<sup>4</sup>,
            </span>
            <span class="author-block">
              Chao Du<sup>4</sup>,
            </span>
            <span class="author-block">
              Aixin Sun<sup>1</sup>,
            </span>
            <span class="author-block">
              Zhuoran Yang<sup>5</sup>
            </span>
          </div>
          
          <br>

          <div class="is-size-5 publication-authors">
            <span class="author-block">*Equal Contribution</span><br/>
            <span class="author-block"><sup>1</sup>Nanyang Technological University,</span>
            <span class="author-block"><sup>2</sup>Agency for Science, Technology and Research, Singapore,</span>
            <span class="author-block"><sup>3</sup>National University of Singapore,</span>
            <span class="author-block"><sup>4</sup>Sea AI Lab,</span>
            <span class="author-block"><sup>5</sup>Yale University</span>
          </div>

          <div class="column has-text-centered">
            <div class="publication-links">
              <span class="link-block">
                <a href="https://arxiv.org/abs/2011.12948"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="ai ai-arxiv"></i>
                  </span>
                  <span>arXiv</span>
                </a>
              </span>
              <!-- Video Link. -->
              <span class="link-block">
                <a href="https://www.youtube.com/watch?v=MrKrnHhk8IA"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fab fa-youtube"></i>
                  </span>
                  <span>Video</span>
                </a>
              </span>
              <!-- Code Link. -->
              <span class="link-block">
                <a href="https://github.com/google/nerfies"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fab fa-github"></i>
                  </span>
                  <span>Code</span>
                  </a>
              </span>
            </div>

          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- <section class="hero teaser">
  <div class="container is-max-desktop">
    <div class="hero-body">
      <video id="teaser" autoplay muted loop playsinline height="100%">
        <source src="./static/videos/teaser.mp4"
                type="video/mp4">
      </video>
      <h2 class="subtitle has-text-centered">
        <span class="dnerf">Nerfies</span> turns selfie videos from your phone into
        free-viewpoint
        portraits.
      </h2>
    </div>
  </div>
</section> -->


<section class="section">
  <div class="container is-max-desktop">
    <!-- Abstract. -->
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 style="text-align: center;", class="title is-3">Abstract</h2>
        <div class="content has-text-justified">
          <p>
            A variety of Auto-Regressive Video Diffusion Models (ARVDM) have achieved remarkable successes in generating realistic long-form videos. However, theoretical analyses of these models remain scant. 
            In this work, we develop theoretical underpinnings for these models and use our insights to improve the performance of existing models. We first develop <code>Meta-ARVDM</code>, a unified framework of 
            ARVDMs that subsumes most existing methods. Using <code>Meta-ARVDM</code>, we analyze the KL-divergence between the videos generated by <code>Meta-ARVDM</code> and the true videos. Our analysis uncovers 
            two important phenomena inherent to ARVDM--<em>error accumulation</em> and <em>memory bottleneck</em>. By deriving an information-theoretic impossibility result, we show that the memory bottleneck 
            phenomenon cannot be avoided. To mitigate the  memory bottleneck, we design various network structures to explicitly use more past frames. We also achieve a significantly improved trade-off 
            between the mitigation of the memory bottleneck and the inference efficiency by compressing the frames. Experimental results on DMLab and Minecraft validate the efficacy of our methods. 
            Our experiments also demonstrate a Pareto-frontier between the error accumulation and memory bottleneck across different methods.
          </p>
        </div>
      </div>
    </div>
    <!--/ Abstract. -->

    <!-- Paper video. -->
    <!-- <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Video Demos</h2>
        <div class="publication-video">
          <iframe src="https://www.youtube.com/embed/MrKrnHhk8IA?rel=0&amp;showinfo=0"
                  frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>
        </div>
      </div>
    </div> -->
    <!--/ Paper video. -->
  </div>
</section>

<!-- End of Selection -->

<section class="section">
  <style>
    ul.custom-list {
        list-style: none; /* Remove default bullets */
        padding: 0;
    }
    ul.custom-list li {
        font-size: 18px;
        background: #f8f9fa;
        padding: 10px;
        margin: 10px 0;
        border-left: 5px solid #007BFF; /* Blue left border */
        border-radius: 5px;
        transition: 0.3s;
    }
    ul.custom-list li:hover {
        background: #e3f2fd;
    }
  </style>
  <script>
    MathJax = {
        tex: {
            inlineMath: [['$', '$'], ['\\(', '\\)']],
            displayMath: [['$$', '$$'], ['\\[', '\\]']]
        }
    };
  </script>
  <script async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
  <div class="container is-max-desktop">
    <!--/ Matting. -->
    <div class="columns is-centered">
      <div class="column is-full-width">
        <h2 style="text-align: center; color: #007BFF;", class="title is-3">Main Messages</h2>
        <ul class="custom-list">
          <li>Most Auto-Regressive Video Diffusion Models (ARVDMs) face <strong>memory bottleneck</strong> and <strong>error accumulation</strong>. The memory bottleneck at each AR 
            step is defined by the <em>conditional mutual information</em> between past states and outputs, given the input. Error accumulation is the <em>cumulative sum of errors</em> from all preceding AR steps.</li>
          <li>The memory bottleneck is <strong>inevitable</strong> but can be <strong>monotonically</strong> reduced by incorporating more historical information into the denoising process.</li>
          <li>The memory bottleneck can be mitigated by letting the <strong>denoising network</strong> take historical frames as inputs in a proper way.</li>
          <li>The memory bottleneck and error accumulation are <strong>correlated</strong>. Less memory bottleneck error implies more error accumulation. </li>
        </ul>
      </div>
    </div>

  <!-- Video Deamonstration -->
  <h2 style="text-align: center;", class="title is-3">Error Accumulation</h2>
  <div class="hero-body">
    <div class="container">
      <div id="results-carousel" class="carousel results-carousel">
        <div class="item item-steve">
          <video poster="" id="steve" autoplay controls muted loop playsinline height="100%">
            <source src="./static/videos/fifo_1_dog_and_2_whales.mp4"
                    type="video/mp4">
          </video>
        </div>
        <div class="item item-chair-tp">
          <video poster="" id="chair-tp" autoplay controls muted loop playsinline height="100%">
            <source src="./static/videos/fifo_a_busy_bakery_filled_with_the_aroma_of_freshly_baked_bread_and_pastries..mp4"
                    type="video/mp4">
          </video>
        </div>
        <div class="item item-shiba">
          <video poster="" id="shiba" autoplay controls muted loop playsinline height="100%">
            <source src="./static/videos/fifo_a_car_on_the_left_of_a_bus_oil_painting_style.mp4"
                    type="video/mp4">
          </video>
        </div>
        <div class="item item-fullbody">
          <video poster="" id="fullbody" autoplay controls muted loop playsinline height="100%">
            <source src="./static/videos/outpaint_a_beautiful_mosque_stands_tall_in_the_city_center_.mp4"
                    type="video/mp4">
          </video>
        </div>
        <div class="item item-blueshirt">
          <video poster="" id="blueshirt" autoplay controls muted loop playsinline height="100%">
            <source src="./static/videos/outpaint_a_big_ferris_wheel_is_rotating_in_an_amusement_park_.mp4"
                    type="video/mp4">
          </video>
        </div>
        <div class="item item-mosque">
          <video poster="" id="mosque" autoplay controls muted loop playsinline height="100%">
            <source src="./static/videos/outpaint_a_cheerleader_performs_a_large_split__somersault__landing_in_a_motion.mp4"
                    type="video/mp4">
          </video>
        </div>
        <div class="item item-camping">
          <video poster="" id="camping" autoplay controls muted loop playsinline height="100%">
            <source src="./static/videos/outpaint_a_family_of_four_set_up_a_tent_and_build_a_campfire__enjoying_a_night_of_camping_under_the_stars.mp4"
                    type="video/mp4">
          </video>
        </div>
      </div>
    </div>
  </div>

  <h2 class="title is-3" style="text-align: center;">Memory Bottleneck</h2>
  <div class="container">
    <div class="row no-gutters">
      <div class="col-12">
        <video controls playsinline autoplay loop muted src="./static/videos/oasis_memory_bottleneck_oasis_part_2.mp4" width="24%" style="border-radius:10px; border:1px solid black"></video>
        <video controls playsinline autoplay loop muted src="./static/videos/oasis_memory_bottleneck_oasis_part_3.mp4" width="24%" style="border-radius:10px; border:1px solid black"></video>
        <video controls playsinline autoplay loop muted src="./static/videos/oasis_memory_bottleneck_oasis_part_4.mp4" width="24%" style="border-radius:10px; border:1px solid black"></video>
        <video controls playsinline autoplay loop muted src="./static/videos/oasis_memory_bottleneck_oasis_part_5.mp4" width="24%" style="border-radius:10px; border:1px solid black"></video>
        <video controls playsinline autoplay loop muted src="./static/videos/session_1812380d-3554-4947-9b35-c6d2555ebfcb_part_1.mp4" width="24%" style="border-radius:10px; border:1px solid black"></video>
        <video controls playsinline autoplay loop muted src="./static/videos/session_1812380d-3554-4947-9b35-c6d2555ebfcb_part_2.mp4" width="24%" style="border-radius:10px; border:1px solid black"></video>
        <video controls playsinline autoplay loop muted src="./static/videos/session_1812380d-3554-4947-9b35-c6d2555ebfcb_part_3.mp4" width="24%" style="border-radius:10px; border:1px solid black"></video>
        <video controls playsinline autoplay loop muted src="./static/videos/session_1812380d-3554-4947-9b35-c6d2555ebfcb_part_4.mp4" width="24%" style="border-radius:10px; border:1px solid black"></video>
        <!-- <video controls playsinline autoplay loop muted src="./static/videos/session_ca514c9f-8953-4ca6-b918-7ed6e4d7c734_part_1.mp4" width="24%" style="border-radius:10px; border:1px solid black"></video>
        <video controls playsinline autoplay loop muted src="./static/videos/session_ca514c9f-8953-4ca6-b918-7ed6e4d7c734_part_2.mp4" width="24%" style="border-radius:10px; border:1px solid black"></video>
        <video controls playsinline autoplay loop muted src="./static/videos/session_ca514c9f-8953-4ca6-b918-7ed6e4d7c734_part_3.mp4" width="24%" style="border-radius:10px; border:1px solid black"></video>
        <video controls playsinline autoplay loop muted src="./static/videos/session_ca514c9f-8953-4ca6-b918-7ed6e4d7c734_part_4.mp4" width="24%" style="border-radius:10px; border:1px solid black"></video> -->
      </div>
    </div>
  </div>

  <br><br>

  <h2 class="title is-3" style="text-align: center;">Memory Retrieval</h2>
        <div class="container">
            <div class="content has-text-justified">The left frame displays the ground truth, while the right frame with a white border the model prediction based on memory.</div>
            <!-- <h3 class="title is-4" style="text-align: left;">DMLab</h3> -->
            <div class="row no-gutters">
                <div class="col-12">
                    <video controls playsinline autoplay loop muted src="./static/videos/dmlab_success_007_0_16_54_76.mp4" width="24%" style="border-radius:10px; border:1px solid black"></video>
                    <video controls playsinline autoplay loop muted src="./static/videos/dmlab_success_017_0_309_256_288.mp4" width="24%" style="border-radius:10px; border:1px solid black"></video>
                    <video controls playsinline autoplay loop muted src="./static/videos/dmlab_success_017_0_328_70_102.mp4" width="24%" style="border-radius:10px; border:1px solid black"></video>
                    <video controls playsinline autoplay loop muted src="./static/videos/dmlab_success_019_0_311_141_175.mp4" width="24%" style="border-radius:10px; border:1px solid black"></video>
                    <video controls playsinline autoplay loop muted src="./static/videos/dmlab_success_020_0_312_117_152.mp4" width="24%" style="border-radius:10px; border:1px solid black"></video>
                    <video controls playsinline autoplay loop muted src="./static/videos/dmlab_success_020_0_315_260_295.mp4" width="24%" style="border-radius:10px; border:1px solid black"></video>
                    <video controls playsinline autoplay loop muted src="./static/videos/dmlab_success_043_0_10_196_254.mp4" width="24%" style="border-radius:10px; border:1px solid black"></video>
                    <video controls playsinline autoplay loop muted src="./static/videos/dmlab_success_044_0_301_239_298.mp4" width="24%" style="border-radius:10px; border:1px solid black"></video>
                    <video controls playsinline autoplay loop muted src="./static/videos/dmlab_success_047_0_341_141_203.mp4" width="24%" style="border-radius:10px; border:1px solid black"></video>
                    <video controls playsinline autoplay loop muted src="./static/videos/dmlab_success_049_0_332_30_94.mp4" width="24%" style="border-radius:10px; border:1px solid black"></video>
                    <video controls playsinline autoplay loop muted src="./static/videos/dmlab_success_060_0_302_24_99.mp4" width="24%" style="border-radius:10px; border:1px solid black"></video>
                    <video controls playsinline autoplay loop muted src="./static/videos/dmlab_success_060_0_338_167_242.mp4" width="24%" style="border-radius:10px; border:1px solid black"></video>
                </div>
            </div>
            <br>
            <div class="columns is-centered">
                <div class="content has-text-justified">
                    <b>Success Cases</b> ðŸ˜Š. The model successfully retrieves the memory and reconstructs the scene.
                </div>
            </div>

            <div class="row no-gutters">
              <div class="col-12">
                  <video controls playsinline autoplay loop muted src="./static/videos/dmlab_fail_047_0_320_186_248.mp4" width="24%" style="border-radius:10px; border:1px solid black"></video>
                  <video controls playsinline autoplay loop muted src="./static/videos/dmlab_fail_054_0_340_28_97.mp4" width="24%" style="border-radius:10px; border:1px solid black"></video>
                  <video controls playsinline autoplay loop muted src="./static/videos/dmlab_fail_055_0_304_106_176.mp4" width="24%" style="border-radius:10px; border:1px solid black"></video>
                  <video controls playsinline autoplay loop muted src="./static/videos/dmlab_fail_063_0_5_47_125.mp4" width="24%" style="border-radius:10px; border:1px solid black"></video>
              </div>
          </div>
          <br>
          <div class="columns is-centered">
            <div class="content has-text-justified">
                <b>Failed Cases</b> ðŸ˜¢. The model either fails to retrieve the exact color or fails to reconstruct the terrain.
            </div>
          </div>

            <!-- <h3 class="title is-4" style="text-align: left;">Minecraft</h3>
            <div class="col-12">
                <video controls playsinline autoplay loop muted src="./static/videos/minecraft_success_minerlbasaltbuildvillagehouse_v0_20016.mp4" width="24%" style="border-radius:10px; border:1px solid black"></video>
                <video controls playsinline autoplay loop muted src="./static/videos/minecraft_success_minerlbasaltbuildvillagehouse_v0_20051.mp4" width="24%" style="border-radius:10px; border:1px solid black"></video>
                <video controls playsinline autoplay loop muted src="./static/videos/minecraft_success_minerlbasaltfindcave_v0_20089.mp4" width="24%" style="border-radius:10px; border:1px solid black"></video>
                <video controls playsinline autoplay loop muted src="./static/videos/minecraft_success_minerlbasaltmakewaterfall_v0_21294.mp4" width="24%" style="border-radius:10px; border:1px solid black"></video>
                <video controls playsinline autoplay loop muted src="./static/videos/minecraft_success_minerlbasaltmakewaterfall_v0_21411.mp4" width="24%" style="border-radius:10px; border:1px solid black"></video>
                <video controls playsinline autoplay loop muted src="./static/videos/minecraft_success_minerlbasaltmakewaterfall_v0_23006.mp4" width="24%" style="border-radius:10px; border:1px solid black"></video>
                <video controls playsinline autoplay loop muted src="./static/videos/minecraft_success_minerlbasaltmakewaterfall_v0_24346.mp4" width="24%" style="border-radius:10px; border:1px solid black"></video>
                <video controls playsinline autoplay loop muted src="./static/videos/minecraft_success_minerlbasaltmakewaterfall_v0_25259.mp4" width="24%" style="border-radius:10px; border:1px solid black"></video>
                <video controls playsinline autoplay loop muted src="./static/videos/minecraft_success_minerlbasaltmakewaterfall_v0_25959.mp4" width="24%" style="border-radius:10px; border:1px solid black"></video>
                <video controls playsinline autoplay loop muted src="./static/videos/minecraft_success_minerlbasaltmakewaterfall_v0_26688.mp4" width="24%" style="border-radius:10px; border:1px solid black"></video>
                <video controls playsinline autoplay loop muted src="./static/videos/minecraft_success_minerlbasaltmakewaterfall_v0_27547.mp4" width="24%" style="border-radius:10px; border:1px solid black"></video>
            </div> -->
        </div>
    <!--/ Video Deamonstration -->
    <br><br>


    <!-- Animation. -->
    <div class="columns is-centered">
      <div class="column is-full-width">
        <h2 style="text-align: center;", class="title is-3">Methodology Overview</h2>

        <!-- Interpolating. -->
        <h3 class="title is-4">A Unified Framework of ARVDMs</h3>
        <div class="content has-text-justified">
          <p>
            We build a unified framework <code>Meta-ARVDM</code>, which includes most ARVDMs, to study the errors shared by them.
          </p>
          <img src="./static/images/framework.jpg" alt="Meta-ARVDM" width="1200">
          <p>
            We identify conditions: <span style="color: #84BD00;">Monotonicity</span>, <span style="color: #e4002b;">Circularity</span>, and <span style="color: #DA1884;">$0-T$ Boundary</span>.
          </p>
        </div>

        <h3 class="title is-4">Theoretical Analysis</h3>
        <div class="content has-text-justified">
          <p>
            The error of <em>long</em> videos $Y_{1:K\Delta}^{0}$ generated by  <code>Meta-ARVDM</code> can be decomposed as follows.
            \[
            \begin{align*}
              \mathrm{KL}(X_{1:K\Delta}^{0}\,\|\,Y_{1:K\Delta}^{0})\lesssim \mathrm{NIE} +  \mathrm{SEE} + \mathrm{DE} + \sum_{k=1}^K  \mathrm{NIE}_{\mathrm{A}\mathrm{R}} +  \mathrm{SEE}_{\mathrm{A}\mathrm{R}} + \mathrm{DE}_{\mathrm{A}\mathrm{R}} + \mathrm{MB}_k .
            \end{align*}
            \]
            It contains noise initialization errors ($\mathrm{NIE}, \mathrm{NIE}_{\mathrm{A}\mathrm{R}}$), score estimation erros ($\mathrm{SEE},\mathrm{SEE}_{\mathrm{A}\mathrm{R}}$), 
            discretization error ($\mathrm{DE},\mathrm{DE}_{\mathrm{A}\mathrm{R}}$), and <strong>memory bottleneck</strong> ($\mathrm{MB}_k$). Here the memory bottleneck is the conditional mutual information between the past and output of an AR step conditioned on the input, i.e.,
            \[
            \begin{align*}
              \mathrm{MB}_k:= I\big( \texttt{Output}_k ; \texttt{Past}_k \big|\texttt{Input}_k\big).
            \end{align*}
            \]

            The error of <em>short</em> video clip $ Y_{K\Delta+1:(K+1)\Delta}^{0}$ is decomposed as follows.
            \[
            \begin{align*}
              \mathrm{KL}\big( X_{K\Delta+1:(K+1)\Delta}^{0}\big\| Y_{K\Delta+1:(K+1)\Delta}^{0} \big)\lesssim \mathrm{I}\mathrm{E} + K\big[  \mathrm{NIE}_{\mathrm{AR}} + \mathrm{SEE}_{\mathrm{AR}}  + \mathrm{DE}_{\mathrm{AR}}  \big]
            \end{align*}
            \]
            The multiplicative factor $K$ reflects the <strong>error accumulation</strong> in the video clips generated in $K$-th AR step.
          </p>
    
        </div>
        
        <h3 class="title is-4">Mitigation of Memory Bottleneck</h3>
        <div class="content has-text-justified">
          <p>
            For general random variables $X,Y,Z$ and any deterministic function $g$, we have (<span style="color: #FF0000;">adding historical data helps!</span>)
            \[
            \begin{align*}
              I(X;Z|Y,g(X))\leq I(X;Z|Y).
            \end{align*}
            \]
            We augment the denoising networks as
          </p>
          <img src="./static/images/networks.jpg" alt="network structure" width="1200">
        </div>
      </div>
    </div>
    <!--/ Animation. -->


    
  </div>
</section>


<section class="section" id="BibTeX">
  <div class="container is-max-desktop content">
    <h2 class="title">BibTeX</h2>
    <pre><code>@article{park2021nerfies,
  author    = {Park, Keunhong and Sinha, Utkarsh and Barron, Jonathan T. and Bouaziz, Sofien and Goldman, Dan B and Seitz, Steven M. and Martin-Brualla, Ricardo},
  title     = {Nerfies: Deformable Neural Radiance Fields},
  journal   = {ICCV},
  year      = {2021},
}</code></pre>
  </div>
</section>




</body>
</html>
